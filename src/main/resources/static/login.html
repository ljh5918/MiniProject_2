<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 50px; }
        input, button { margin: 5px 0; padding: 8px; width: 300px; }
        #result { margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <h2>ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h2>
    <form id="loginForm">
        <input type="email" id="email" placeholder="ì´ë©”ì¼" required><br>
        <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" required><br>
        <button type="submit">ë¡œê·¸ì¸</button>
    </form>

    <button id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>

    <div id="result"></div>

    <script>
        const form = document.getElementById('loginForm');
        const logoutBtn = document.getElementById('logoutBtn');
        const resultDiv = document.getElementById('result');

        // ë¡œê·¸ì¸
		form.addEventListener('submit', async (e) => {
		    e.preventDefault();
		
		    const data = {
		        email: document.getElementById('email').value,
		        password: document.getElementById('password').value
		    };
		
		    try {
		        const response = await fetch('/user/login', {
		            method: 'POST',
		            headers: { 'Content-Type': 'application/json' },
		            body: JSON.stringify(data),
		            credentials: 'include'  // ì¿ í‚¤ ì €ì¥ë¨ (ì¤‘ìš”)
		        });
		
		        const result = await response.json(); 
		
		        if (result.status === 'success') {
		            resultDiv.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ!';
		
		            // ğŸ”¥ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ index.htmlë¡œ ì´ë™!
		            window.location.href = result.redirect;  
		            return;
		        }
		
		        resultDiv.textContent = 'ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + result.message;
		
		    } catch (err) {
		        resultDiv.textContent = 'ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + err.message;
		    }
		});


        // ë¡œê·¸ì•„ì›ƒ
        logoutBtn.addEventListener('click', async () => {
            try {
                const response = await fetch('/user/logout', {
                    method: 'POST'
                });

                const result = await response.json();
                if (result.status === 'success') {
                    resultDiv.textContent = 'ë¡œê·¸ì•„ì›ƒ ì„±ê³µ!';
                } else {
                    resultDiv.textContent = 'ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨: ' + result.message;
                }

            } catch (err) {
                resultDiv.textContent = 'ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨: ' + err.message;
            }
        });
    </script>
</body>
</html>
